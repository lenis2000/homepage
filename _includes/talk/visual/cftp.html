<section class="slide slide-top" id="cftp" data-title="Exact Sampling: I need to know when to stop">
    <h2 class="slide-title">Exact Sampling: I need to know when to stop waiting</h2>

    <div style="display: grid; grid-template-columns: 48vw 44vw; gap: 2vw; margin-top: 2vh; padding: 0 2vw;">
        <!-- Left column: CFTP explanation -->
        <div style="display: flex; flex-direction: column; gap: 2vh; font-size: clamp(1.2rem, 2.2vw, 1.8rem);">
            <!-- CFTP (single unified pane) -->
            <div id="cftp-explain" style="background: #f5f5f5; border-left: 4px solid var(--slide-accent); padding: 1.5vh 1.5vw; text-align: left; opacity: 0; transition: opacity 0.3s;">
                <strong style="color: var(--slide-accent);">Coupling From The Past (CFTP)</strong>
                <span style="color: var(--slide-muted);">[Propp–Wilson 1996]</span>
                <div style="margin-top: 0.5vh;">
                    Surfaces are <strong>partially ordered</strong> by height function. The Markov chain is <strong>monotone</strong>, so it suffices to track just the <strong>maximal</strong> and <strong>minimal</strong> chains.
                </div>
                <ul style="margin: 0.5vh 0 0 1.2em; padding: 0;">
                    <li>The stationary chain is <strong>somewhere in between</strong> the maximal and minimal surfaces</li>
                    <li>Run coupled dynamics — when max and min <strong>coalesce</strong>, we've <strong>caught</strong> the stationary chain</li>
                    <li>Output is an <strong>exact</strong> sample from the stationary distribution</li>
                </ul>
            </div>

            <!-- Key point -->
            <div id="cftp-exact" style="background: #fff3e0; border-left: 4px solid #E57200; padding: 1.5vh 1.5vw; text-align: left; opacity: 0; transition: opacity 0.3s;">
                <strong style="color: #E57200; font-size: 1.1em;">Not approximately random — EXACTLY random.</strong>
                <div style="margin-top: 0.5vh;">
                    Compare with calculus: we know \(1/n \to 0\), but for which \(n\) is it equal to zero?
                    <br>
                    <div style="height: 0.5em;"></div>
                        Here we reach the limit <strong>exactly</strong> — but at a <strong>random</strong> time.
                </div>
            </div>
        </div>

        <!-- Right column: 3D simulation canvas -->
        <div style="display: flex; flex-direction: column; gap: 1vh; align-items: center;">
            <div id="cftp-hex-label" style="font-size: clamp(1rem, 1.8vw, 1.4rem); color: var(--slide-muted); opacity: 0; transition: opacity 0.3s;">Hexagon 35 × 35 × 35</div>
            <canvas id="cftp-sim-canvas" width="1200" height="800" style="height: 52vh; width: auto; border-radius: 8px;"></canvas>
            <div id="cftp-sim-status" style="font-size: clamp(1.2rem, 2.2vw, 1.8rem); color: var(--slide-muted); min-height: 1.5em;"></div>
        </div>
    </div>

    <!-- QR code centered below -->
    <div style="text-align: center; margin-top: 1.5vh;">
        <a id="cftp-qr" href="https://lpetrov.cc/lozenge-draw/" target="_blank" style="display: inline-flex; align-items: center; gap: 1vw; text-decoration: none;">
            <img src="images/qr-lozenge-draw.png" alt="QR code to lozenge-draw" style="height: 12vh; width: auto;">
            <span style="font-size: clamp(1.2rem, 2.2vw, 1.8rem); color: var(--slide-muted);">lpetrov.cc/lozenge-draw</span>
        </a>
    </div>
</section>
