---
layout: slides
title: "Random Lozenge Waterfall"
description: "Interactive talk on random lozenge tilings and their limit shapes"
---

<!-- Service Worker Registration & Asset Preloader -->
<script>
(function() {
  // Register service worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/talk/waterfall/sw.js', { scope: '/talk/waterfall/' })
      .then(reg => console.log('SW registered:', reg.scope))
      .catch(err => console.warn('SW registration failed:', err));
  }

  // Asset preloader with progress bar
  const criticalAssets = [
    '/js/three.min.js',
    '/js/OrbitControls.js',
    '/js/colorschemes.js',
    '/js/slide-engine.js',
    '/talk/visual/sim/visual-lozenge.js',
    '/talk/visual/sim/visual-lozenge-threaded.js',
    '/talk/visual/sim/q-partition-cftp.js',
    '/letters/Rotunda.json',
    '/katex-0.16.9/katex.min.js',
    '/katex-0.16.9/katex.min.css'
  ];

  let loaded = 0;
  const total = criticalAssets.length;

  function updateLoader() {
    const bar = document.getElementById('asset-loader-bar');
    const text = document.getElementById('asset-loader-text');
    const container = document.getElementById('asset-loader');
    if (!bar || !text || !container) return;

    const pct = Math.round((loaded / total) * 100);
    bar.style.width = pct + '%';

    if (loaded >= total) {
      text.textContent = 'Ready';
      setTimeout(() => {
        container.style.opacity = '0';
        setTimeout(() => container.remove(), 500);
      }, 500);
    } else {
      text.textContent = `Loading assets (${loaded}/${total})`;
    }
  }

  // Preload assets
  criticalAssets.forEach(url => {
    fetch(url, { cache: 'force-cache' })
      .then(() => { loaded++; updateLoader(); })
      .catch(() => { loaded++; updateLoader(); });
  });

  // Update on DOMContentLoaded in case elements weren't ready
  document.addEventListener('DOMContentLoaded', updateLoader);
})();
</script>

<!-- Load simulation dependencies (colorschemes.js already loaded by slides layout) -->
<script src="/js/three.min.js"></script>
<script src="/js/OrbitControls.js"></script>
<script src="/js/2025-06-08-q-vol-3d.js"></script>

<!-- Dynamic WASM loader: use threaded version if SharedArrayBuffer is available -->
<script>
window.VISUAL_THREADED = typeof SharedArrayBuffer !== 'undefined';
window.VISUAL_WEBGPU = !!navigator.gpu;

// Load WASM module dynamically (no document.write)
function loadScript(src) {
    return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = src;
        script.onload = resolve;
        script.onerror = reject;
        document.head.appendChild(script);
    });
}

const wasmSrc = '/talk/visual/sim/visual-lozenge' + (window.VISUAL_THREADED ? '-threaded' : '') + '.js';
const qpartSrc = '/talk/visual/sim/q-partition-cftp.js';

Promise.all([
    loadScript(wasmSrc),
    loadScript(qpartSrc)
]).then(() => {
    // Load WebGPU lozenge engine, then signal ready
    loadScript('/js/webgpu-lozenge-engine.js')
        .catch(e => console.log('WebGPU engine not available'))
        .finally(() => window.dispatchEvent(new Event('wasm-loaded')));
});
</script>

<!-- ==================== SLIDES ==================== -->
<!-- Applied Math Colloquium variant (~18 slides) -->

<!-- Act 1: From Randomness to Shapes -->
{% include talk/waterfall/title.html %}

{% include talk/waterfall/nature-builds.html %}

{% include talk/waterfall/part1-intro.html %}

{% include talk/waterfall/grid-paths.html %}

{% include talk/waterfall/random-path.html %}

{% include talk/waterfall/part2-intro.html %}

{% include talk/waterfall/2to3d.html %}

<!-- Act 2: Variational Framework -->
{% include talk/waterfall/limit-shape.html %}

{% include talk/waterfall/energy.html %}

{% include talk/waterfall/complex-burgers.html %}

{% include talk/waterfall/universality-zoom.html %}

<!-- Act 3: Breaking the Framework -->
{% include talk/waterfall/q-volume.html %}

{% include talk/waterfall/q-racah-brief.html %}

{% include talk/waterfall/q-racah-large-hexagons.html %}

{% include talk/waterfall/dimensional-collapse.html %}

<!-- Act 4: Wrapup -->
{% include talk/waterfall/computational.html %}

{% include talk/waterfall/summary-colloquium.html %}

{% include talk/waterfall/thankyou.html %}

<!-- ==================== SIMULATION SCRIPTS ==================== -->
<!-- Only scripts for slides included in this variant -->
<script src="js/title-sim.js" defer></script>
<script src="js/nature-builds-sim.js" defer></script>
<script src="js/grid-paths-sim.js" defer></script>
<script src="js/random-path-sim.js" defer></script>
<script src="js/2to3d-sim.js" defer></script>
<script src="js/limit-shape-sim.js" defer></script>
<script src="js/energy-sim.js" defer></script>
<script src="js/universality-zoom-sim.js" defer></script>
<script src="js/q-volume-sim.js" defer></script>
<script src="js/q-racah-large-hexagons-sim.js" defer></script>
<script src="js/dimensional-collapse-sim.js" defer></script>
<script src="js/summary-sim.js" defer></script>
<script src="js/thankyou-sim.js" defer></script>

<!-- Global: Escape/Enter key blurs input fields for slide navigation -->
<script>
document.addEventListener('keydown', (e) => {
    if ((e.key === 'Escape' || e.key === 'Enter') && document.activeElement &&
        (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA')) {
        document.activeElement.blur();
        e.preventDefault();
    }
});
</script>
