\documentclass[letterpaper,11pt,oneside,reqno]{article}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[pdftex,backref=page,colorlinks=true,linkcolor=blue,citecolor=red]{hyperref}
\usepackage[alphabetic,nobysame]{amsrefs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%main packages
\usepackage{amsmath,amssymb,amsthm,amsfonts,mathtools}
\usepackage{graphicx,color}
\usepackage{upgreek}
\usepackage[mathscr]{euscript}

%equations
\allowdisplaybreaks
\numberwithin{equation}{section}

%tikz
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,positioning,decorations.markings}

%conveniences
\usepackage{array}
\usepackage{adjustbox}
\usepackage{cleveref}
\usepackage{enumerate}
\usepackage{datetime}
\usepackage{comment}

%paper geometry
\usepackage[DIV=12]{typearea}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%draft-specific
\synctex=1
% \usepackage{refcheck,comment}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%this paper specific
\newcommand{\ssp}{\hspace{1pt}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}[proposition]{Lemma}
\newtheorem{corollary}[proposition]{Corollary}
\newtheorem{theorem}[proposition]{Theorem}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{definition}
\newtheorem{definition}[proposition]{Definition}
\newtheorem{remark}[proposition]{Remark}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newenvironment{lnotes}{\section*{Notes for the lecturer}}{}


\begin{document}
\title{Lectures on Random Matrices
(Spring 2025) \\Lecture 2: Wigner semicircle law}


\date{Wednesday, January 15, 2025\footnote{\href{https://lpetrov.cc/rmt25/}{\texttt{Course webpage}}
$\bullet$ \href{https://lpetrov.cc/rmt25/rmt25-notes/rmt2025-l01.tex}{\texttt{TeX Source}}
$\bullet$
Updated at \currenttime, \today}}



\author{Leonid Petrov}


\maketitle



\begin{lnotes}
	PREP:
	\begin{enumerate}
		\item Start:
			Catalan number formula
		\item Moments of SC need to be computed
		\item
			SC is uniquely determined by its moments; need Carleman criterion to show that the moments determine the distribution.
		\item from expected moments to the full convergence, some analysis needed
	\end{enumerate}
\end{lnotes}


\section{Recap}

We are working on the Wigner semicircle law.
\begin{enumerate}
	\item Wigner matrices $W$:
		real symmetric random matrices with iid entries
		$X_{ij}$, $i>j$ (mean 0, variance $\sigma^2$);
		and iid diagonal entries $X_{ii}$ (mean 0, some other variance and distribution).
	\item Empirical spectral distribution (ESD)
		\begin{equation*}
			\nu_n = \frac{1}{n} \sum_{i=1}^{n} \delta_{\lambda_i/\sqrt{n}},
		\end{equation*}
		which is a random probability measure on $\mathbb{R}$.
	\item Semicircle distribution $\mu_{\mathrm{sc}}$:
		\begin{equation*}
			\mu_{\mathrm{sc}}(dx) = \frac{1}{2\pi} \sqrt{4-x^2} \, dx,
			\qquad x \in [-2,2].
		\end{equation*}
	\item Computation of expected traces of powers of $W$. We
		showed that
		\begin{equation*}
			\int_{\mathbb{R}}x^k \nu_n(dx)\to
			\#\left\{ \textnormal{rooted planar trees with $k/2$ edges} \right\}.
		\end{equation*}
\end{enumerate}

\section{Two computations}

First, we finish the combinatorial part,
and match the limiting expected traces of powers of $W$
to moments of the semicircle law.

\subsection{Moments of the semicircle law}

We also need to match the Catalan numbers to the moments of the semicircle law.
Let $k=2m$, and we need to compute
the integral
\begin{equation*}
	\int_{-2}^{2} x^{2m} \frac{1}{2\pi} \sqrt{4-x^2} \, dx.
\end{equation*}

By symmetry, we write:
\[
\int_{-2}^2 x^{2m}\rho(x)\, dx = \frac{2}{\pi} \int_0^2 x^{2m} \sqrt{4-x^2}\, dx.
\]

Using the substitution \(x = 2\sin\theta\), we have \(dx = 2\cos\theta\, d\theta\). The integral becomes:
\[
\frac{2}{\pi} \int_0^{\pi/2} (2\sin\theta)^{2m} (2\cos\theta) (2\cos\theta\, d\theta)
= \frac{2^{2m+2}}{\pi} \int_0^{\pi/2} \sin^{2m}\theta \cos^2\theta\, d\theta.
\]
Using \(\cos^2\theta = 1 - \sin^2\theta\), we split the integral:
\[
\frac{2^{2m+2}}{\pi} \left( \int_0^{\pi/2} \sin^{2m}\theta\, d\theta - \int_0^{\pi/2} \sin^{2m+2}\theta\, d\theta \right).
\]
Using the standard formula (cf. Problem \ref{prob:sin-integral})
\begin{equation}
	\label{eq:sin-integral}
\int_0^{\pi/2} \sin^{2n}\theta\, d\theta = \frac{\pi}{2} \frac{(2n)!}{2^{2n} (n!)^2},
\end{equation}
we compute each term:
\[
\frac{2^{2m+2}}{\pi} \left( \frac{\pi}{2} \frac{(2m)!}{2^{2m}(m!)^2} - \frac{\pi}{2} \frac{(2m+2)!}{2^{2m+2}((m+1)!)^2} \right).
\]
After simplification, this becomes
$C_m$, the $m$-th Catalan number.

\subsection{Counting trees and Catalan numbers}

Throughout this section, for a random matrix trace moment of order $k$,
we use $m=k/2$ as our main parameter. Note that $m$ can be arbitrary
(not necessarily even).

\begin{definition}[Dyck Path]
A \emph{Dyck path} of semilength $m$ is a sequence of $2m$ steps in the plane, each step being either $(1,1)$ (up step) or $(1,-1)$ (down step), starting at $(0,0)$ and ending at $(2m,0)$, such that the path never goes below the $x$-axis. We denote an up step by $U$ and a down step by $D$.
\end{definition}

\begin{definition}[Rooted Plane Tree]
A \emph{rooted plane tree} is a tree with a designated root vertex where the children of each vertex have a fixed left-to-right ordering. The size of such a tree is measured by its number of edges, which we denote by $m$.
\end{definition}

\begin{definition}[Catalan Numbers]
The sequence of \emph{Catalan numbers} $\{C_m\}_{m\geq 0}$ is defined recursively by:
\begin{equation}
	\label{eq:catalan-recurrence}
    C_0 = 1, \quad C_{m+1} = \sum_{j=0}^m C_j C_{m-j} \quad \text{for } m \geq 0.
\end{equation}
Alternatively, they have the closed form:
\begin{equation}
	\label{eq:catalan-closed}
    C_m = \frac{1}{m+1}\binom{2m}{m} =
		\binom{2m}{m} - \binom{2m}{m+1}.
\end{equation}
These numbers appear naturally in the moments of random matrices, where $m=k/2$ for trace moments of order $k$.
\end{definition}

\begin{lemma}
	\label{lemma:equivalence-catalan}
	Formulas
	\eqref{eq:catalan-recurrence} and \eqref{eq:catalan-closed} are equivalent.
\end{lemma}
\begin{proof}
	One can check that the closed form satisfies the recurrence relation by direct substitution. The other direction
	involves generating functions. Namely,
	\eqref{eq:catalan-recurrence} can be rewritten for the
	generating function
	\begin{equation*}
		C(z)=\sum_{m=0}^\infty C_m z^m
	\end{equation*}
	as
	\begin{equation*}
		C(z)=1+zC(z)^2.
	\end{equation*}
	Solving for $C(z)$, we get
	\begin{equation}
		\label{eq:catalan-generating}
		C(z)=\frac{1\pm \sqrt{1-4z}}{2z}.
	\end{equation}
	We need to pick the solution which is nonsingular at $z=0$,
	and it corresponds to the minus sign.
	Taylor expansion of the right-hand side of
	\eqref{eq:catalan-generating}
	at $z=0$
	gives the closed form.
\end{proof}

\begin{remark}
	\label{rmk:stanley-catalans}
	Catalan numbers enumerate many (too many!) combinatorial objects. For a comprehensive treatment, see \cite{stanley2015catalan}.
\end{remark}

\begin{proposition}[Dyck Path--Rooted Tree Correspondence]
	\label{prop:dyck-tree}
For any $m$, there exists a bijection between
the set of Dyck paths of semilength $m$ and the set of rooted plane trees with $m$ edges.
\end{proposition}

\begin{proof}
Given a Dyck path of semilength $m$, we build the corresponding rooted plane tree as follows
(see \Cref{fig:dyck_paths_m2} for an illustration):
\begin{enumerate}
    \item Start with a single root vertex
    \item Read the Dyck path from left to right:
        \begin{itemize}
            \item For each up step ($U$), add a new child to the current vertex
            \item For each down step ($D$), move back to the parent of the current vertex
        \end{itemize}
    \item The order of children is determined by the order of up steps
\end{enumerate}
This is clearly a bijection, and we are done.
\end{proof}


\begin{figure}[htpb]
\centering
\begin{tikzpicture}[scale=0.8]
    % First Dyck path (UUDD)
    \begin{scope}[xshift=0cm]
        % Grid
        \draw[help lines,gray!30] (0,0) grid[step=1] (4,2);
        \draw[->,gray!50] (-0.2,0) -- (4.2,0) node[right] {$x$};
        \draw[->,gray!50] (0,-0.2) -- (0,2.2) node[above] {$y$};

        % Path
        \draw[thick,blue] (0,0) -- (1,1) -- (2,2) -- (3,1) -- (4,0);

        % Label
        \node[below] at (2,-0.5) {UUDD};
    \end{scope}

    % First tree
    \begin{scope}[xshift=6cm,level distance=1cm,
        every node/.style={circle,draw,minimum size=0.5cm}]
        \node (a) {1}
            child {node (b) {2}
                child {node (c) {3}}
            };
    \end{scope}

    % Second Dyck path (UDUD)
    \begin{scope}[xshift=10cm]
        % Grid
        \draw[help lines,gray!30] (0,0) grid[step=1] (4,2);
        \draw[->,gray!50] (-0.2,0) -- (4.2,0) node[right] {$x$};
        \draw[->,gray!50] (0,-0.2) -- (0,2.2) node[above] {$y$};

        % Path
        \draw[thick,red] (0,0) -- (1,1) -- (2,0) -- (3,1) -- (4,0);

        % Label
        \node[below] at (2,-0.5) {UDUD};
    \end{scope}

    % Second tree
    \begin{scope}[xshift=16cm,level distance=1cm,
        every node/.style={circle,draw,minimum size=0.5cm}]
        \node (a) {1}
            child {node (b) {2}}
            child {node (c) {3}};
    \end{scope}
\end{tikzpicture}
\caption{The two possible Dyck paths of semilength $m=2$ and their corresponding rooted plane trees.}
\label{fig:dyck_paths_m2}
\end{figure}

It remains to show that the Dyck paths or rooted plane trees are counted by the Catalan numbers, by verifying
the recursion \eqref{eq:catalan-recurrence} for them.
By \Cref{prop:dyck-tree}, it suffices to
consider only Dyck paths.

\begin{proposition}
	\label{prop:dyck-recurrence}
	The number of Dyck paths of semilength $m$ satisfies the Catalan recurrence \eqref{eq:catalan-recurrence}.
\end{proposition}
\begin{proof}
	We need to show that the number of Dyck paths of semilength $m+1$ is given by the sum in the right-hand side of \eqref{eq:catalan-recurrence}.
	Consider a Dyck path of semilength $m+1$,
	and let the \emph{first} time it
	returns to zero be at semilength $j+1$,
	where $j=0,\ldots,m$.
	Then the
	first and the $(2j+1)$-st steps are,
	respectively, $U$ and $D$.
	From $0$ to $2j+2$, the path does not return to the $x$-axis,
	so we can remove the first and the $(2j+1)$-st steps, and get a proper Dyck path of semilength $j$.
	The remainder of the Dyck path is a Dyck path of semilength $m-j$.
	This yields the desired recurrence.
\end{proof}
\begin{figure}[htbp]
	\centering
	\begin{tikzpicture}[scale=0.8]
		% Drawing the Dyck path with highlighted portions
		\draw[thick] (0,0) -- (1,1) -- (2,2) -- (3,1) -- (4,2) -- (5,1) -- (6,0)
		-- (7,1) -- (8,0)--++(1,1)--++(1,1)--++(1,-1)--++(1,-1)--++(1,1)--++(1,-1);

		% Axes and labels
		\draw[->] (-0.5,0) -- (16.5,0) node[right] {$x$};
		\draw[->] (0,-0.5) -- (0,4.5) node[above] {$y$};


		% Highlight important steps for recurrence explanation
		\draw[line width=2pt,red] (0,0) -- (1,1);
		\draw[line width=2pt,red] (5,1) -- (6,0);
	\end{tikzpicture}
	\caption{Illustration of a Dyck path decomposition for the proof of \Cref{prop:dyck-recurrence}.}
	\label{fig:dyck_recurrence}
\end{figure}


\section{Analysis steps in the proof}

We are done with combinatorics, and it remains to justify that
the computations lead to the desired semicircle law
from \href{https://lpetrov.cc/rmt25/rmt25-notes/rmt2025-l01.pdf}{Lecture 1}.

Let us remember that so far, we showed that
\begin{equation*}
	\lim_{n\to\infty}
	\frac{1}{n^{k/2+1}}
	\operatorname{\mathbb{E}}
	\left[ 
		\operatorname{Tr} W^k
	\right]
	=
	\begin{cases}
		\sigma^{2m} C_{m} & \text{if $k=2m$ is even}, \\
		0 & \text{if $k$ is odd}.
	\end{cases}
\end{equation*}
Here, $W$ is real Wigner
(unnormalized) with mean $0$,
where its off-diagonal entries are iid with variance $\sigma^2$.

\subsection{The semicircle distribution is determined by its moments}
\label{sub:carleman-semicircle}

We use (without proof)
the known Carleman's criterion for the uniqueness of a distribution by its moments.
\begin{proposition}[{\cite[Theorem~1.10]{shohat1943problem}}, \cite{Akhiezer1965Moment}]
	\label{prop:carleman}
	Let $X$ be a real-valued random variable with moments $m_k
	= \mathbb{E}[X^k]$ of all orders. If \[\sum_{k=1}^{\infty}
	(m_{2k})^{-1/(2k)} = \infty,\] then the distribution of
	$X$ is uniquely determined by its moments $(m_k)_{k\geq 1}$.
\end{proposition}
\begin{remark}
	By the Stone-Wierstrass theorem, 
	the semicircle distribution is the unique distribution
	with compact support with these moments.
	However, we need to guarantee that there are no 
	distributions on $\mathbb{R}$ with the same moments.
\end{remark}

Now, the moments satisfy the asymptotics
\begin{equation*}
	m_{2k}=C_k \sigma^{2k} \sim 
	\frac{4^k}{k^{3/2}\sqrt{\pi}} \sigma^{2k},
\end{equation*}
so
\begin{equation*}
	\sum_{k=1}^{\infty} (m_{2k})^{-1/(2k)} \sim
	\sum_{k=1}^{\infty} \left( \frac{k^{3/2}\sqrt{\pi}}{4^k} \right)^{1/2k} \sigma^{-1}.
\end{equation*}
The $k$-th summands converges to $1/(2\sigma)$, so the 
series diverges.

\begin{remark}
	See also Problem A.4 from \href{https://lpetrov.cc/rmt25/rmt25-notes/rmt2025-l01.pdf}{Lecture 1} on an example of a distribution not determined by its moments.
\end{remark}

\subsection{Convergence to the semicircle law}

Recall 
\cite[Theorem~30.2]{billingsley1995probability}
that convergence 
of random variables
in moments plus the fact that the
limiting distribution is uniquely determined by its moments
implies convergence in distribution.
However, we need weak in probability convergence,
which deals with random variables
\begin{equation*}
	\int_{\mathbb{R}} f(x) \nu_n(dx),\qquad f\in C_b(\mathbb{R}),
\end{equation*}
and we did not compute the moments of these random variables.



\appendix
\setcounter{section}{1}

\section{Problems (due 2025-02-15)}

\subsection{Standard formula}
\label{prob:sin-integral}

Prove formula \eqref{eq:sin-integral}:
\begin{equation*}
	\int_0^{\pi/2} \sin^{2n}\theta\, d\theta = \frac{\pi}{2} \frac{(2n)!}{2^{2n} (n!)^2}.
\end{equation*}


\subsection{Tree profiles}
	Show that the expected height of a uniformly random Dyck path of semilength $m$ is of order~$\sqrt{m}$.

\subsection{Ballot problem}


Suppose candidate \(A\) receives \(p\) votes and candidate \(B\) receives \(q\) votes, where \(p > q \geq 0\). In how many ways can these votes be counted such that \(A\) is always strictly ahead of \(B\) in partial tallies?




\bibliographystyle{alpha}
\bibliography{bib}


\medskip

\textsc{L. Petrov, University of Virginia, Department of Mathematics, 141 Cabell Drive, Kerchof Hall, P.O. Box 400137, Charlottesville, VA 22904, USA}

E-mail: \texttt{lenia.petrov@gmail.com}


\end{document}
